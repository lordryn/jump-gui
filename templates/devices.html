{% extends "base.html" %}
{% block title %}Dashboard - ConnectBox{% endblock %}
{% block content %}
    <h2>Welcome, {{ session['username'] }}</h2>
    <a href="{{ url_for('logout') }}">Logout</a>

    <h3>Registered Devices</h3>
    <table>
        <tr>
            <th>ID</th>
            <th>Hostname</th>
            <th>Port</th>
            <th>Status</th>
            <th>Registered</th>
            <th>Notes</th>
            <th>Actions</th>
        </tr>
        {% for device in devices %}
        <tr>
            <td>{{ device.id }}</td>
            <td>{{ device.hostname }}</td>
            <td>{{ device.port }}</td>
            <td>{{ device.status }}</td>
            <td>{{ device.registered }}</td>
            <td>{{ device.notes }}</td>
            <td>
                <form method="post" action="{{ url_for('ping_device', device_id=device.id) }}" style="display:inline;">
                    <button type="submit">Ping</button>
                </form>
                <form method="post" action="{{ url_for('delete_device', device_id=device.id) }}" style="display:inline;">
                    <button type="submit">Delete</button>
                </form>
                <a href="{{ url_for('console_device', device_id=device.id) }}">Console</a>
            </td>
        </tr>
        {% endfor %}
    </table>

    <h3>Register New Device</h3>
    <form method="post" action="{{ url_for('register') }}">
        <label for="hostname">Hostname:</label><br>
        <input type="text" name="hostname" required><br>
        <label for="port">Port:</label><br>
        <input type="number" name="port" required><br>
        <label for="notes">Notes:</label><br>
        <input type="text" name="notes"><br>
        <button type="submit">Register</button>
    </form>
{% endblock %}
